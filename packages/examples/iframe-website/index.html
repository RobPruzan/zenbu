<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic Brick Breaker</title>
    <script src="http://localhost:42069"></script>
    <style>
      body {
        font-family: 'Arial', sans-serif;
        margin: 0;
        padding: 0;
        overflow: hidden;
        background-color: #000;
      }
      
      #game-container {
        position: relative;
        width: 100vw;
        height: 100vh;
      }
      
      #starfield {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1;
      }
      
      #nebula {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 2;
        opacity: 0.5;
      }
      
      #paddle {
        position: absolute;
        width: 120px;
        height: 20px;
        background-color: #00ffff;
        border-radius: 10px;
        box-shadow: 0 0 10px #00ffff;
        z-index: 10;
        bottom: 30px;
      }
      
      #ball {
        position: absolute;
        width: 20px;
        height: 20px;
        background-color: #ffffff;
        border-radius: 50%;
        box-shadow: 0 0 10px #ffffff;
        z-index: 9;
      }
      
      .brick {
        position: absolute;
        width: 80px;
        height: 30px;
        border-radius: 5px;
        z-index: 8;
      }
      
      .dust {
        position: absolute;
        width: 2px;
        height: 2px;
        background-color: rgba(255, 255, 255, 0.5);
        z-index: 3;
      }
      
      #hud {
        position: absolute;
        top: 10px;
        left: 10px;
        color: #fff;
        font-size: 18px;
        z-index: 100;
      }
      
      #game-over {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #fff;
        font-size: 48px;
        text-align: center;
        z-index: 200;
        display: none;
      }
      
      #start-screen {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #fff;
        font-size: 24px;
        text-align: center;
        z-index: 200;
      }
      
      button {
        background-color: #00ffff;
        color: #000;
        border: none;
        padding: 10px 20px;
        font-size: 18px;
        border-radius: 5px;
        cursor: pointer;
        margin-top: 20px;
      }
      
      button:hover {
        background-color: #66ffff;
      }
      
      .particle {
        position: absolute;
        width: 5px;
        height: 5px;
        border-radius: 50%;
        z-index: 7;
      }
    </style>
  </head>
  <body>
    <div id="game-container">
      <div id="starfield"></div>
      <div id="nebula"></div>
      <div id="paddle"></div>
      <div id="ball"></div>
      <div id="hud">
        <div id="score">Score: 0</div>
        <div id="lives">Lives: 3</div>
      </div>
      <div id="game-over">
        <h1>Game Over</h1>
        <p id="final-score">Score: 0</p>
        <button id="restart-button">Play Again</button>
      </div>
      <div id="start-screen">
        <h1>Cosmic Brick Breaker</h1>
        <p>Use left and right arrow keys to move the paddle</p>
        <p>Break all the bricks to win!</p>
        <button id="start-button">Start Game</button>
      </div>
    </div>
    
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const gameContainer = document.getElementById('game-container');
        const paddle = document.getElementById('paddle');
        const ball = document.getElementById('ball');
        const starfield = document.getElementById('starfield');
        const nebula = document.getElementById('nebula');
        const scoreDisplay = document.getElementById('score');
        const livesDisplay = document.getElementById('lives');
        const gameOverScreen = document.getElementById('game-over');
        const finalScoreDisplay = document.getElementById('final-score');
        const restartButton = document.getElementById('restart-button');
        const startScreen = document.getElementById('start-screen');
        const startButton = document.getElementById('start-button');
        
        // Game state
        const state = {
          paddleX: window.innerWidth / 2 - 60,
          ballX: window.innerWidth / 2 - 10,
          ballY: window.innerHeight - 60,
          ballSpeedX: 0,
          ballSpeedY: 0,
          ballLaunched: false,
          lives: 3,
          score: 0,
          bricks: [],
          dust: [],
          particles: [],
          keys: {
            ArrowLeft: false,
            ArrowRight: false,
            Space: false
          },
          gameActive: false,
          gameOver: false,
          brickColors: [
            '#ff0066', '#ff3300', '#ff6600', '#ffcc00', 
            '#33cc33', '#00ccff', '#3366ff', '#cc33ff'
          ]
        };
        
        // Initialize stars
        function createStars() {
          for (let i = 0; i < 200; i++) {
            const star = document.createElement('div');
            star.className = 'dust';
            star.style.left = `${Math.random() * 100}%`;
            star.style.top = `${Math.random() * 100}%`;
            star.style.width = `${Math.random() * 3 + 1}px`;
            star.style.height = star.style.width;
            star.style.opacity = Math.random();
            star.dataset.speed = Math.random() * 2 + 0.5;
            starfield.appendChild(star);
            state.dust.push(star);
          }
        }
        
        // Create nebula effect
        function createNebula() {
          const colors = ['#ff00ff', '#00ffff', '#ff6600', '#9900ff'];
          for (let i = 0; i < 5; i++) {
            const cloud = document.createElement('div');
            cloud.style.position = 'absolute';
            cloud.style.width = `${Math.random() * 300 + 200}px`;
            cloud.style.height = `${Math.random() * 300 + 200}px`;
            cloud.style.borderRadius = '50%';
            cloud.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            cloud.style.filter = 'blur(60px)';
            cloud.style.opacity = '0.2';
            cloud.style.left = `${Math.random() * 100}%`;
            cloud.style.top = `${Math.random() * 100}%`;
            nebula.appendChild(cloud);
          }
        }
        
        // Create bricks
        function createBricks() {
          // Clear existing bricks
          state.bricks.forEach(brick => {
            if (brick.element && brick.element.parentNode) {
              gameContainer.removeChild(brick.element);
            }
          });
          state.bricks = [];
          
          const brickWidth = 80;
          const brickHeight = 30;
          const rows = 5;
          const cols = Math.floor((window.innerWidth * 0.8) / brickWidth);
          const startX = (window.innerWidth - (cols * brickWidth)) / 2;
          const startY = 80;
          const padding = 10;
          
          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              const brick = document.createElement('div');
              brick.className = 'brick';
              const colorIndex = Math.floor(Math.random() * state.brickColors.length);
              brick.style.backgroundColor = state.brickColors[colorIndex];
              brick.style.boxShadow = `0 0 10px ${state.brickColors[colorIndex]}`;
              
              const x = startX + col * (brickWidth + padding);
              const y = startY + row * (brickHeight + padding);
              
              brick.style.left = `${x}px`;
              brick.style.top = `${y}px`;
              
              gameContainer.appendChild(brick);
              
              state.bricks.push({
                element: brick,
                x: x,
                y: y,
                width: brickWidth,
                height: brickHeight,
                color: state.brickColors[colorIndex],
                hit: false
              });
            }
          }
        }
        
        // Handle keyboard input
        function setupControls() {
          window.addEventListener('keydown', (e) => {
            if (e.code in state.keys) {
              state.keys[e.code] = true;
              if (e.code === 'Space' && !state.ballLaunched && state.gameActive) {
                launchBall();
              }
            }
          });
          
          window.addEventListener('keyup', (e) => {
            if (e.code in state.keys) {
              state.keys[e.code] = false;
            }
          });
          
          restartButton.addEventListener('click', restartGame);
          startButton.addEventListener('click', startGame);
        }
        
        // Launch ball
        function launchBall() {
          if (!state.ballLaunched) {
            state.ballLaunched = true;
            // Random angle between -45 and 45 degrees
            const angle = (Math.random() * 90 - 45) * Math.PI / 180;
            const speed = 8;
            state.ballSpeedX = Math.sin(angle) * speed;
            state.ballSpeedY = -Math.cos(angle) * speed;
          }
        }
        
        // Update paddle position
        function updatePaddle() {
          const paddleSpeed = 10;
          
          if (state.keys.ArrowLeft && state.paddleX > 0) {
            state.paddleX -= paddleSpeed;
          }
          if (state.keys.ArrowRight && state.paddleX < window.innerWidth - 120) {
            state.paddleX += paddleSpeed;
          }
          
          paddle.style.left = `${state.paddleX}px`;
          
          // If ball is not launched, make it follow the paddle
          if (!state.ballLaunched) {
            state.ballX = state.paddleX + 50;
            ball.style.left = `${state.ballX}px`;
            ball.style.top = `${state.ballY}px`;
          }
        }
        
        // Update ball position
        function updateBall() {
          if (!state.ballLaunched) return;
          
          state.ballX += state.ballSpeedX;
          state.ballY += state.ballSpeedY;
          
          // Wall collision
          if (state.ballX <= 0 || state.ballX >= window.innerWidth - 20) {
            state.ballSpeedX = -state.ballSpeedX;
            createParticles(state.ballX, state.ballY, '#ffffff', 5);
          }
          
          if (state.ballY <= 0) {
            state.ballSpeedY = -state.ballSpeedY;
            createParticles(state.ballX, state.ballY, '#ffffff', 5);
          }
          
          // Paddle collision
          if (state.ballY >= window.innerHeight - 50 && 
              state.ballY <= window.innerHeight - 30 &&
              state.ballX >= state.paddleX - 20 &&
              state.ballX <= state.paddleX + 120) {
            
            // Calculate bounce angle based on where the ball hits the paddle
            const hitPosition = (state.ballX - state.paddleX) / 120; // 0 to 1
            const angle = (hitPosition * 120 - 60) * Math.PI / 180; // -60 to 60 degrees
            const speed = Math.sqrt(state.ballSpeedX * state.ballSpeedX + state.ballSpeedY * state.ballSpeedY);
            
            state.ballSpeedX = Math.sin(angle) * speed;
            state.ballSpeedY = -Math.cos(angle) * speed;
            
            createParticles(state.ballX, state.ballY, '#00ffff', 8);
          }
          
          // Bottom collision (lose life)
          if (state.ballY >= window.innerHeight) {
            state.lives--;
            livesDisplay.textContent = `Lives: ${state.lives}`;
            
            if (state.lives <= 0) {
              endGame();
            } else {
              resetBall();
            }
          }
          
          // Brick collision
          checkBrickCollision();
          
          ball.style.left = `${state.ballX}px`;
          ball.style.top = `${state.ballY}px`;
        }
        
        // Check for collision with bricks
        function checkBrickCollision() {
          for (let i = 0; i < state.bricks.length; i++) {
            const brick = state.bricks[i];
            
            if (brick.hit) continue;
            
            if (state.ballX < brick.x + brick.width &&
                state.ballX + 20 > brick.x &&
                state.ballY < brick.y + brick.height &&
                state.ballY + 20 > brick.y) {
              
              // Determine collision direction
              const ballCenterX = state.ballX + 10;
              const ballCenterY = state.ballY + 10;
              const brickCenterX = brick.x + brick.width / 2;
              const brickCenterY = brick.y + brick.height / 2;
              
              const dx = ballCenterX - brickCenterX;
              const dy = ballCenterY - brickCenterY;
              
              // Horizontal collision
              if (Math.abs(dx) > Math.abs(dy)) {
                state.ballSpeedX = -state.ballSpeedX;
              } else {
                // Vertical collision
                state.ballSpeedY = -state.ballSpeedY;
              }
              
              // Mark brick as hit
              brick.hit = true;
              brick.element.style.visibility = 'hidden';
              
              // Create particles
              createParticles(state.ballX, state.ballY, brick.color, 15);
              
              // Update score
              state.score += 10;
              scoreDisplay.textContent = `Score: ${state.score}`;
              
              // Check if all bricks are hit
              if (state.bricks.every(b => b.hit)) {
                // Level complete
                state.score += 100;
                scoreDisplay.textContent = `Score: ${state.score}`;
                
                // Create new level
                setTimeout(() => {
                  createBricks();
                  resetBall();
                }, 1000);
              }
              
              break;
            }
          }
        }
        
        // Reset ball position
        function resetBall() {
          state.ballLaunched = false;
          state.ballX = state.paddleX + 50;
          state.ballY = window.innerHeight - 60;
          state.ballSpeedX = 0;
          state.ballSpeedY = 0;
        }
        
        // Create particle effects
        function createParticles(x, y, color, count) {
          for (let i = 0; i < count; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.backgroundColor = color;
            particle.style.left = `${x + 10}px`;
            particle.style.top = `${y + 10}px`;
            
            gameContainer.appendChild(particle);
            
            const angle = Math.random() * Math.PI * 2;
            const speed = Math.random() * 5 + 2;
            const lifetime = Math.random() * 1000 + 500;
            
            state.particles.push({
              element: particle,
              x: x + 10,
              y: y + 10,
              vx: Math.cos(angle) * speed,
              vy: Math.sin(angle) * speed,
              alpha: 1,
              created: Date.now(),
              lifetime: lifetime
            });
          }
        }
        
        // Update particles
        function updateParticles() {
          const now = Date.now();
          
          for (let i = state.particles.length - 1; i >= 0; i--) {
            const particle = state.particles[i];
            
            particle.x += particle.vx;
            particle.y += particle.vy;
            
            const age = now - particle.created;
            particle.alpha = 1 - (age / particle.lifetime);
            
            particle.element.style.left = `${particle.x}px`;
            particle.element.style.top = `${particle.y}px`;
            particle.element.style.opacity = particle.alpha;
            
            if (age >= particle.lifetime) {
              gameContainer.removeChild(particle.element);
              state.particles.splice(i, 1);
            }
          }
        }
        
        // Update stars
        function updateStars() {
          state.dust.forEach(star => {
            const speed = parseFloat(star.dataset.speed);
            const y = parseFloat(star.style.top);
            star.style.top = `${(y + speed) % 100}%`;
          });
        }
        
        // End game
        function endGame() {
          state.gameActive = false;
          state.gameOver = true;
          finalScoreDisplay.textContent = `Score: ${state.score}`;
          gameOverScreen.style.display = 'block';
        }
        
        // Restart game
        function restartGame() {
          state.lives = 3;
          state.score = 0;
          state.gameOver = false;
          
          scoreDisplay.textContent = `Score: ${state.score}`;
          livesDisplay.textContent = `Lives: ${state.lives}`;
          
          gameOverScreen.style.display = 'none';
          
          createBricks();
          resetBall();
          
          state.gameActive = true;
        }
        
        // Start game
        function startGame() {
          startScreen.style.display = 'none';
          state.gameActive = true;
          resetBall();
        }
        
        // Game loop
        function gameLoop() {
          if (state.gameActive) {
            updatePaddle();
            updateBall();
            updateParticles();
          }
          
          updateStars();
          
          requestAnimationFrame(gameLoop);
        }
        
        // Initialize game
        function init() {
          paddle.style.left = `${state.paddleX}px`;
          ball.style.left = `${state.ballX}px`;
          ball.style.top = `${state.ballY}px`;
          
          createStars();
          createNebula();
          createBricks();
          setupControls();
          gameLoop();
        }
        
        init();
      });
    </script>
  </body>
</html>